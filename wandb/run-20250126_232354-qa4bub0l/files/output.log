policy_gradient_wx.py:163: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at ../torch/csrc/utils/tensor_new.cpp:278.)
  state = torch.tensor(state_list, dtype=torch.float).to(device)
/home/lixiang/.local/lib/python3.8/site-packages/gym/logger.py:30: UserWarning: [33mWARN: You are calling 'step()' even though this environment has already returned done = True. You should always call 'reset()' once you receive 'done = True' -- any further steps are undefined behavior.[0m
  warnings.warn(colorize('%s: %s'%('WARN', msg % args), 'yellow'))
policy_gradient_wx.py:105: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  action = torch.tensor(transition_dict['actions']).view(-1, 1).to(self.device)
Episode 0: Loss 206.19373995345086 dones_mean 22.4140625
Episode 1: Loss 181.61576896393672 dones_mean 21.359375
Episode 2: Loss 226.41218467941508 dones_mean 24.03125
Episode 3: Loss 180.561606625095 dones_mean 21.65625
Episode 4: Loss 191.23289332631975 dones_mean 21.7421875
Episode 5: Loss 189.5858308202587 dones_mean 21.7421875
Episode 6: Loss 179.8049113349989 dones_mean 21.734375
Episode 7: Loss 181.91737411124632 dones_mean 22.1328125
Episode 8: Loss 185.65112846484408 dones_mean 22.421875
Episode 9: Loss 178.21432206733152 dones_mean 21.2890625
Episode 10: Loss 185.2437550467439 dones_mean 21.671875
Episode 11: Loss 201.90765009401366 dones_mean 23.703125
Episode 12: Loss 184.39061234984547 dones_mean 22.5390625
Episode 13: Loss 183.77703358558938 dones_mean 23.125
Episode 14: Loss 198.40172620583326 dones_mean 23.984375
Episode 15: Loss 188.67182625224814 dones_mean 22.53125
Episode 16: Loss 220.50567045807838 dones_mean 24.59375
Episode 17: Loss 155.79115436552092 dones_mean 20.4921875
Episode 18: Loss 175.12112896284088 dones_mean 21.71875
Episode 19: Loss 163.8646250325255 dones_mean 21.640625
Episode 20: Loss 173.2517265714705 dones_mean 22.0546875
Episode 21: Loss 188.9548470703885 dones_mean 23.1796875
Episode 22: Loss 143.9201734517701 dones_mean 21.3046875
Episode 23: Loss 113.98318674135953 dones_mean 23.1171875
Episode 24: Loss 129.2289092731662 dones_mean 20.3359375
Episode 25: Loss 176.9830155535601 dones_mean 22.2578125
Episode 26: Loss 164.6301164077595 dones_mean 22.765625
Episode 27: Loss 158.2542562680319 dones_mean 23.71875
Episode 28: Loss 179.6946736271493 dones_mean 24.03125
Episode 29: Loss 192.40943804336712 dones_mean 24.203125
Episode 30: Loss 200.63493838813156 dones_mean 23.78125
Episode 31: Loss 149.12581428838894 dones_mean 21.828125
Episode 32: Loss 108.03619031002745 dones_mean 21.8359375
Episode 33: Loss 122.78835755260661 dones_mean 22.2109375
Episode 34: Loss 161.73482398875058 dones_mean 24.2890625
Episode 35: Loss 131.4487476684153 dones_mean 21.34375
Episode 36: Loss 149.60621849028394 dones_mean 21.9921875
Episode 37: Loss 154.0951880980283 dones_mean 23.25
Episode 38: Loss 158.19789187517017 dones_mean 22.84375
Episode 39: Loss 159.69256236683577 dones_mean 23.1875
Episode 40: Loss 90.64488224219531 dones_mean 21.546875
Episode 41: Loss 159.73054794222116 dones_mean 24.6015625
Episode 42: Loss 94.76369455922395 dones_mean 23.0078125
Episode 43: Loss 102.15428541880101 dones_mean 24.546875
Episode 44: Loss 162.59863008651882 dones_mean 25.0390625
Episode 45: Loss 160.6051800600253 dones_mean 22.7109375
Episode 46: Loss 170.40700437966734 dones_mean 23.1484375
Episode 47: Loss 186.83370052929968 dones_mean 24.203125
Episode 48: Loss 109.52715554367751 dones_mean 25.390625
Episode 49: Loss 139.20637856191024 dones_mean 23.421875
Episode 50: Loss 159.57972113601863 dones_mean 24.109375
Episode 51: Loss 202.12929220171645 dones_mean 25.21875
Episode 52: Loss 189.52191511308774 dones_mean 24.4765625
Episode 53: Loss 194.75307916663587 dones_mean 27.0546875
Episode 54: Loss 196.34846217324957 dones_mean 25.0546875
Episode 55: Loss 226.34625293966383 dones_mean 26.328125
Episode 56: Loss 233.76210500113666 dones_mean 27.2421875
Episode 57: Loss 246.37007173895836 dones_mean 27.7890625
Episode 58: Loss 183.4827439673245 dones_mean 24.71875
Episode 59: Loss 180.50664706807584 dones_mean 26.4140625
Episode 60: Loss 187.29989712312818 dones_mean 26.8671875
Episode 61: Loss 201.85773148899898 dones_mean 25.890625
Episode 62: Loss 210.30111718550324 dones_mean 28.5
Episode 63: Loss 90.2412279183045 dones_mean 28.0234375
Episode 64: Loss 215.147680811584 dones_mean 26.40625
Episode 65: Loss 181.59703167760745 dones_mean 24.921875
Episode 66: Loss 187.67205064790323 dones_mean 29.328125
Episode 67: Loss 182.61227752640843 dones_mean 26.7890625
Episode 68: Loss 77.09770287759602 dones_mean 26.9375
Episode 69: Loss 216.21203203080222 dones_mean 28.6328125
Episode 70: Loss 171.93871544813737 dones_mean 28.4609375
Episode 71: Loss 237.0383257730864 dones_mean 31.2578125
Episode 72: Loss 150.11105727031827 dones_mean 28.109375
Episode 73: Loss 200.78168040933087 dones_mean 28.5703125
Episode 74: Loss 208.31934593850747 dones_mean 29.0546875
Episode 75: Loss 197.13931442098692 dones_mean 27.984375
Episode 76: Loss 214.1732345437631 dones_mean 27.1328125
Episode 77: Loss 181.9951504971832 dones_mean 28.203125
Episode 78: Loss 245.8322336031124 dones_mean 30.9375
Episode 79: Loss 315.39234882965684 dones_mean 34.6484375
Episode 80: Loss 81.27365670446306 dones_mean 33.0703125
Episode 81: Loss 234.7482716566883 dones_mean 35.984375
Episode 82: Loss 259.1935588128399 dones_mean 31.53125
Episode 83: Loss 222.65917466813698 dones_mean 32.09375
Episode 84: Loss 201.4759204997681 dones_mean 29.1015625
Episode 85: Loss 237.83541799895465 dones_mean 31.625
Episode 86: Loss 263.1234178529121 dones_mean 32.7421875
Episode 87: Loss 181.7118597268127 dones_mean 32.2578125
Episode 88: Loss 260.6715142605826 dones_mean 31.9921875
Episode 89: Loss 259.07529299799353 dones_mean 37.1015625
Episode 90: Loss 302.4111096318811 dones_mean 33.0859375
Episode 91: Loss 297.1142634069547 dones_mean 33.1328125
Episode 92: Loss 157.63619905058295 dones_mean 31.0703125
Episode 93: Loss 206.03150963643566 dones_mean 34.0859375
Episode 94: Loss 208.4458260666579 dones_mean 33.2578125
Episode 95: Loss 242.64452791772783 dones_mean 34.59375
Episode 96: Loss 260.51945038558915 dones_mean 33.96875
Episode 97: Loss 247.5654196725227 dones_mean 31.546875
Episode 98: Loss 199.13804123178124 dones_mean 37.3046875
Episode 99: Loss 271.034764024429 dones_mean 35.609375
Episode 100: Loss 140.26627307664603 dones_mean 35.8125
Episode 101: Loss 195.27481105504557 dones_mean 39.0703125
Episode 102: Loss 270.540702059865 dones_mean 41.328125
Episode 103: Loss 226.51440161839128 dones_mean 44.640625
Episode 104: Loss 326.6379048791714 dones_mean 44.3046875
Episode 105: Loss 232.90651313122362 dones_mean 43.0
Episode 106: Loss 187.94731773994863 dones_mean 49.546875
Episode 107: Loss 211.46831203298643 dones_mean 51.0625
Episode 108: Loss 403.309056810569 dones_mean 48.2578125
Episode 109: Loss 277.1431719516404 dones_mean 43.6171875
Episode 110: Loss 352.33971795625985 dones_mean 52.390625
Episode 111: Loss 458.65065945871174 dones_mean 59.515625
Episode 112: Loss 393.0100048943423 dones_mean 64.6484375
Episode 113: Loss 250.40443293144926 dones_mean 58.3046875
Episode 114: Loss 377.1560768894851 dones_mean 63.90625
Episode 115: Loss 662.3535822825506 dones_mean 73.4140625
Episode 116: Loss 601.6612347508781 dones_mean 70.609375
Episode 117: Loss 442.446103090886 dones_mean 66.78125
Episode 118: Loss 730.2138573564589 dones_mean 81.125
Episode 119: Loss 643.1941807549447 dones_mean 76.078125
Episode 120: Loss 663.6479877699167 dones_mean 76.1875
Episode 121: Loss 700.7545603234321 dones_mean 80.6484375
Episode 122: Loss 876.1076515726745 dones_mean 88.75
Episode 123: Loss 833.263560930267 dones_mean 85.6328125
Episode 124: Loss 1023.3754951748997 dones_mean 93.921875
Episode 125: Loss 1574.609559521079 dones_mean 108.84375
Episode 126: Loss 1770.7980661988258 dones_mean 115.7890625
Episode 127: Loss 1822.870207220316 dones_mean 118.96875
Episode 128: Loss 2232.8111417517066 dones_mean 130.4765625
Episode 129: Loss 2210.2752404883504 dones_mean 127.015625
Episode 130: Loss 2018.7603110149503 dones_mean 123.5390625
Episode 131: Loss 2179.1314386427402 dones_mean 130.953125
Episode 132: Loss 2443.794933691621 dones_mean 138.0390625
Episode 133: Loss 2408.289178073406 dones_mean 141.0703125
Episode 134: Loss 2411.6288927197456 dones_mean 140.0
Episode 135: Loss 2855.3132808953524 dones_mean 153.1796875
Episode 136: Loss 3004.3735133856535 dones_mean 155.875
Episode 137: Loss 3348.33457839489 dones_mean 166.5625
Episode 138: Loss 3411.7976892888546 dones_mean 168.828125
Episode 139: Loss 3295.4278669059277 dones_mean 164.65625
Episode 140: Loss 3310.2782289087772 dones_mean 163.0390625
Episode 141: Loss 3268.449186101556 dones_mean 162.171875
Episode 142: Loss 3332.8881801515818 dones_mean 163.3984375
Episode 143: Loss 3431.898634672165 dones_mean 167.3671875
Episode 144: Loss 3751.6013273000717 dones_mean 178.0703125
Episode 145: Loss 3705.3780902028084 dones_mean 176.671875
Episode 146: Loss 3672.9502349048853 dones_mean 176.2109375
Episode 147: Loss 3697.878094136715 dones_mean 177.2578125
Episode 148: Loss 3724.552486002445 dones_mean 178.359375
Episode 149: Loss 3823.813570767641 dones_mean 180.609375
Episode 150: Loss 3680.804666161537 dones_mean 178.9375
Episode 151: Loss 3826.1827218830585 dones_mean 183.75
Episode 152: Loss 3992.8209432065487 dones_mean 189.90625
Episode 153: Loss 3865.1148837804794 dones_mean 185.734375
Episode 154: Loss 3792.292209625244 dones_mean 183.90625
Episode 155: Loss 3896.280839920044 dones_mean 187.4765625
Episode 156: Loss 3715.989015907049 dones_mean 182.7109375
Episode 157: Loss 3925.1278869211674 dones_mean 187.9140625
Episode 158: Loss 3997.695876121521 dones_mean 190.4765625
Episode 159: Loss 3771.678162485361 dones_mean 185.453125
Episode 160: Loss 3966.9445954561234 dones_mean 190.0
Episode 161: Loss 3873.018801033497 dones_mean 186.3125
Episode 162: Loss 3609.749504804611 dones_mean 180.46875
Episode 163: Loss 3861.9488772153854 dones_mean 187.640625
Episode 164: Loss 3929.1980125308037 dones_mean 189.96875
Episode 165: Loss 3668.882332444191 dones_mean 183.3046875
Episode 166: Loss 3544.428647905588 dones_mean 181.3359375
Episode 167: Loss 3647.973380804062 dones_mean 183.359375
Episode 168: Loss 3600.6043531298637 dones_mean 182.4765625
Episode 169: Loss 3819.200830101967 dones_mean 186.7890625
Episode 170: Loss 4076.9391397833824 dones_mean 194.4921875
Episode 171: Loss 4064.4095269441605 dones_mean 195.2734375
Episode 172: Loss 3932.958320915699 dones_mean 192.296875
Episode 173: Loss 3998.107976078987 dones_mean 192.921875
Episode 174: Loss 4022.5743756890297 dones_mean 193.4140625
Episode 175: Loss 4087.257789671421 dones_mean 195.6640625
Episode 176: Loss 4099.609246850014 dones_mean 197.046875
Episode 177: Loss 4140.170421361923 dones_mean 197.796875
Episode 178: Loss 4163.214954614639 dones_mean 198.3671875
Episode 179: Loss 4160.573257386684 dones_mean 198.3203125
Episode 180: Loss 4117.48978304863 dones_mean 197.75
Episode 181: Loss 4102.169390976429 dones_mean 197.7890625
Episode 182: Loss 4084.8997217416763 dones_mean 197.953125
Episode 183: Loss 4049.4816222190857 dones_mean 197.1328125
Episode 184: Loss 4091.818604707718 dones_mean 198.3046875
Episode 185: Loss 4037.2962441444397 dones_mean 197.453125
Episode 186: Loss 4086.7517352104187 dones_mean 198.375
Episode 187: Loss 4054.823976755142 dones_mean 197.5703125
Episode 188: Loss 4059.24989259243 dones_mean 198.109375
Episode 189: Loss 4044.625228047371 dones_mean 198.8828125
Episode 190: Loss 3999.15588504076 dones_mean 197.6484375
Episode 191: Loss 3999.8878983855247 dones_mean 197.390625
Episode 192: Loss 4018.0356029868126 dones_mean 197.734375
Episode 193: Loss 3974.6690244674683 dones_mean 196.21875
Episode 194: Loss 3975.555083334446 dones_mean 196.734375
Episode 195: Loss 3904.9306978583336 dones_mean 193.8046875
Episode 196: Loss 3761.334304153919 dones_mean 190.1484375
Episode 197: Loss 3537.2348630428314 dones_mean 182.875
Episode 198: Loss 3640.0105650424957 dones_mean 186.5703125
Episode 199: Loss 3550.2685353457928 dones_mean 184.2421875
Episode 200: Loss 3913.801715731621 dones_mean 194.0859375
Episode 201: Loss 3868.478431403637 dones_mean 191.78125
Episode 202: Loss 3978.806797206402 dones_mean 193.890625
Episode 203: Loss 3848.5586944818497 dones_mean 191.5859375
Episode 204: Loss 3935.960943877697 dones_mean 194.3125
Episode 205: Loss 3935.3290987610817 dones_mean 194.546875
Episode 206: Loss 3856.1736548542976 dones_mean 192.6328125
Episode 207: Loss 3947.8068783283234 dones_mean 194.7890625
Episode 208: Loss 4034.521350502968 dones_mean 197.1171875
Episode 209: Loss 3962.850144803524 dones_mean 195.4140625
Episode 210: Loss 4020.533814072609 dones_mean 196.7265625
Episode 211: Loss 3952.242053091526 dones_mean 195.75
Episode 212: Loss 3968.8483382463455 dones_mean 194.90625
Episode 213: Loss 4052.1381455659866 dones_mean 197.4765625
Episode 214: Loss 4071.6122171878815 dones_mean 198.3828125
Episode 215: Loss 4077.622860431671 dones_mean 198.84375
Episode 216: Loss 4043.720647394657 dones_mean 198.0859375
Episode 217: Loss 4007.973468840122 dones_mean 198.0078125
Episode 218: Loss 4014.392680346966 dones_mean 197.5859375
Episode 219: Loss 3989.186934232712 dones_mean 197.9375
Episode 220: Loss 4002.72401034832 dones_mean 198.0234375
Episode 221: Loss 3941.816593647003 dones_mean 197.765625
Episode 222: Loss 3982.925816476345 dones_mean 198.296875
Episode 223: Loss 3954.989276409149 dones_mean 196.796875
Episode 224: Loss 3914.4887103438377 dones_mean 195.8046875
Episode 225: Loss 4002.7604080438614 dones_mean 197.578125
Episode 226: Loss 3869.742356479168 dones_mean 193.90625
Episode 227: Loss 3894.2811064124107 dones_mean 194.8125
Episode 228: Loss 3914.241169691086 dones_mean 195.6953125
Episode 229: Loss 3778.505309343338 dones_mean 192.8203125
Episode 230: Loss 3835.17001503706 dones_mean 194.5859375
Episode 231: Loss 3613.1773974001408 dones_mean 188.203125
Episode 232: Loss 3756.1898683309555 dones_mean 191.4296875
Episode 233: Loss 3336.2691287994385 dones_mean 181.375
Episode 234: Loss 3795.1573517918587 dones_mean 191.421875
Episode 235: Loss 3636.9632914066315 dones_mean 187.359375
Episode 236: Loss 3516.5559583306313 dones_mean 184.7734375
Episode 237: Loss 3509.533102631569 dones_mean 184.5234375
Episode 238: Loss 3722.497472822666 dones_mean 189.7265625
Episode 239: Loss 3792.6490052342415 dones_mean 191.53125
Episode 240: Loss 3566.514616280794 dones_mean 186.3125
Episode 241: Loss 3679.429220587015 dones_mean 187.7421875
Episode 242: Loss 3774.0424646139145 dones_mean 191.4375
Episode 243: Loss 3844.009804725647 dones_mean 193.46875
Episode 244: Loss 3403.511270314455 dones_mean 181.96875
Episode 245: Loss 3638.335056632757 dones_mean 187.0234375
Episode 246: Loss 3326.927796036005 dones_mean 180.0859375
Episode 247: Loss 3183.8596734702587 dones_mean 177.5859375
Episode 248: Loss 3282.653520554304 dones_mean 178.9296875
Episode 249: Loss 3433.051466077566 dones_mean 183.953125
Episode 250: Loss 3749.3456317186356 dones_mean 190.7734375
Episode 251: Loss 3784.633255660534 dones_mean 191.0546875
Episode 252: Loss 3975.577080488205 dones_mean 196.375
Episode 253: Loss 3910.091448009014 dones_mean 195.5625
Episode 254: Loss 3900.8857260346413 dones_mean 195.4140625
Episode 255: Loss 3986.6354533433914 dones_mean 198.4609375
Episode 256: Loss 3945.275388419628 dones_mean 197.7890625
Episode 257: Loss 4006.262448132038 dones_mean 199.0
Episode 258: Loss 4010.2398937940598 dones_mean 198.6484375
Episode 259: Loss 4022.3265318870544 dones_mean 198.859375
Traceback (most recent call last):
  File "policy_gradient_wx.py", line 164, in <module>
    action = pg.take_batch_action(state)
  File "policy_gradient_wx.py", line 69, in take_batch_action
    probs = self.policy_net(state)
  File "/home/lixiang/.local/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/lixiang/.local/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "policy_gradient_wx.py", line 41, in forward
    return F.softmax(self.fc2(x), dim=1)
  File "/home/lixiang/.local/lib/python3.8/site-packages/torch/nn/functional.py", line 1888, in softmax
    ret = input.softmax(dim)
KeyboardInterrupt
Traceback (most recent call last):
  File "policy_gradient_wx.py", line 164, in <module>
    action = pg.take_batch_action(state)
  File "policy_gradient_wx.py", line 69, in take_batch_action
    probs = self.policy_net(state)
  File "/home/lixiang/.local/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/lixiang/.local/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "policy_gradient_wx.py", line 41, in forward
    return F.softmax(self.fc2(x), dim=1)
  File "/home/lixiang/.local/lib/python3.8/site-packages/torch/nn/functional.py", line 1888, in softmax
    ret = input.softmax(dim)
KeyboardInterrupt
Exception ignored in: <module 'threading' from '/usr/lib/python3.8/threading.py'>
Traceback (most recent call last):
  File "/usr/lib/python3.8/threading.py", line 1388, in _shutdown
    lock.acquire()
KeyboardInterrupt:
